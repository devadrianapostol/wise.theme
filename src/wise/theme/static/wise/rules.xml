<?xml version="1.0" encoding="UTF-8"?>
<rules
  xmlns="http://namespaces.plone.org/diazo"
  xmlns:css="http://namespaces.plone.org/diazo/css"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <rules css:if-content=".section-index_html" css:if-not-content=".ajax_load">
    <theme href="index.html" css:if-content="#visual-portal-wrapper" />
  </rules>

  <theme href="page.html" css:if-content="#visual-portal-wrapper" css:if-not-content=".ajax_load" />

  <copy css:content="html" css:theme="html" attributes="lang dir" />
  <before css:content="head style, head link, head script, head meta" css:theme-children="head" />
  <replace css:content="head title" css:theme="head title" />
  <copy css:content="head base" css:theme="head base" />
  <drop css:content="head link[rel='shortcut icon']" />
  <drop css:content="head link[rel='apple-touch-icon']" />
  <drop css:theme="script[data-drop='true']" />

  <merge attributes="class" css:content="body" css:theme="body" />
  <copy attributes="id dir" css:content="body" css:theme="body" />
  <copy attributes="role" css:content="content" css:theme="contentspace" />

  <replace css:content="#portal-column-content" css:theme-children=".center-section" />

  <copy attributes="href title" css:content="#portal-logo" css:theme=".brand a" />

  <replace css:theme-children=".breadcrumbs" css:content="#portal-breadcrumbs" method="raw"/>
  <drop css:content="#viewlet-above-content #portal-breadcrumbs" />

  <replace css:theme-children=".navmenu-items">
    <xsl:for-each css:select="#portal-globalnav li">
      <xsl:variable name="klass" select="concat(@class, ' navmenu-item')"></xsl:variable>
      <li class="{$klass}">
        <xsl:apply-templates></xsl:apply-templates>
      </li>
    </xsl:for-each>
  </replace>

</rules>
